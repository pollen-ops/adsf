import numpy as np
from scipy.optimize import curve_fit
import matplotlib.pyplot as plt


porosity = np.array([0.1, 0.15, 0.2, 0.25, 0.3])        # example porosity values
permeability = np.array([1e-14, 2e-14, 5e-14, 1e-13, 2e-13])  # example permeability values

def model_func(phi, alpha, beta, gamma):
    return alpha * phi + beta * phi**2 + gamma * (10 * phi)**10

popt, pcov = curve_fit(model_func, porosity, permeability)

alpha, beta, gamma = popt
print(f"Fitted coefficients:\nAlpha = {alpha:.4e}, Beta = {beta:.4e}, Gamma = {gamma:.4e}")

phi_fit = np.linspace(min(porosity), max(porosity), 100)
k_fit = model_func(phi_fit, *popt)

plt.scatter(porosity, permeability, label='Data', color='blue')
plt.plot(phi_fit, k_fit, label='Fitted Model', color='red')
plt.xlabel('Porosity')
plt.ylabel('Permeability')
plt.title('Porosity vs Permeability Fit')
plt.legend()
plt.grid(True)
plt.tight_layout()
plt.show()
